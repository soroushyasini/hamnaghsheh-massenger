# Hamnaghsheh Chat Plugin

ูพูุงฺฏู ฺุช ู ูพุงูโุฑุณุงู ุจุฑุง ุณุณุชู ูุฏุฑุช ูพุฑูฺู ูููุงูุดู - ุงูฺฉุงู ฺฏูุชฺฏู ุชู ุฏุฑ ูุฑ ูพุฑูฺู

## ูฺฏุงู ฺฉู

ุงู ูพูุงฺฏู ฺฉ ุณุณุชู ฺุช ฺฉุงูู ุจุฑุง ูพูุงฺฏู ุงุตู ูุฏุฑุช ูพุฑูฺู ูููุงูุดู ูุฑุงูู ูโฺฉูุฏ. ุงู ูพูุงฺฏู ุจู ูุงูฺฉุงู ูพุฑูฺูุ ุงุนุถุง ุชู ู ูุฏุฑุงู ุงุฌุงุฒู ูโุฏูุฏ ุฏุฑ ูุญุท ูุฑ ูพุฑูฺู ุจุง ฺฉุฏฺฏุฑ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉููุฏ.

## ูฺฺฏโูุง

### ูฺฺฏโูุง ุงุตู

- **ฺุช ุจูุงุฏุฑูฺฏ**: ุณุณุชู ูุธุฑุณูุฌ ููุดููุฏ ุจุง ููุงุตู ุฒูุงู ุชุทุจู (ฒ-ฑต ุซุงูู)
- **ฺฉูุชุฑู ุฏุณุชุฑุณ**: ููุท ูุงูฺฉ ูพุฑูฺูุ ุงุนุถุง ุชู ู ูุฏุฑุงู ูโุชูุงููุฏ ุจู ฺุช ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ
- **ูพุงูโูุง ุณุณุชู**: ุงุนูุงูโูุง ุฎูุฏฺฉุงุฑ ุจุฑุง ูุนุงูุชโูุง ูุงู (ุขูพููุฏุ ุญุฐูุ ุฌุงฺฏุฒูุ ุฏุงูููุฏุ ูุดุงูุฏู)
- **ููุดู ฺฉุงุฑุจุฑุงู ู ูุงูโูุง**: ุงูฺฉุงู ููุดู ฺฉุฑุฏู ุงุนุถุง ุชู ุจุง @ ู ูุงูโูุง ุจุง #
- **ูุฑุงุด ูพุงู**: ุงูฺฉุงู ูุฑุงุด ูพุงูโูุง ุชุง ฑฐ ุฏููู ูพุณ ุงุฒ ุงุฑุณุงู
- **ูุถุนุช ุฎูุงูุฏู ุดุฏู**: ููุงุด ูุถุนุช ุฏุฏู ุดุฏู ูพุงูโูุง (โ ุงุฑุณุงู ุดุฏูุ โโ ุฏุฏู ุดุฏู)
- **ุฎุฑูุฌ ฺฏุฑูุชู**: ูุงูฺฉุงู ูพุฑูฺู ูโุชูุงููุฏ ุชุงุฑุฎฺู ฺุช ุฑุง ุจู ุตูุฑุช ูุงู ูุชู ุฏุงูููุฏ ฺฉููุฏ
- **ูุญุฏูุฏุช ูุฑุฎ**: ุญุฏุงฺฉุซุฑ ณฐ ูพุงู ุฏุฑ ุฏููู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ
- **ุทุฑุงุญ RTL**: ุทุฑุงุญ ฺฉุงูู ุฑุงุณุช ุจู ฺูพ ุจุฑุง ุฒุจุงู ูุงุฑุณ
- **ุทุฑุงุญ ููุจุงู ุงูู**: ุจูููโุณุงุฒ ุดุฏู ุจุฑุง ุฏุณุชฺฏุงูโูุง ููุจุงู

### ุทุฑุงุญ ู ุจุฑูุฏ

- **ุฑูฺฏ ุงุตู**: `#09375B` (ุขุจ ุชุฑู)
- **ุฑูฺฏ ุชุงฺฉุฏ**: `#FFCF00` (ุฒุฑุฏ ุทูุง)
- **ูููุช**: Vazirmatn (ูููุช ูุงุฑุณ/RTL)
- **Border radius**: ฺฏุฑุฏ ุดุฏู ุจุฑุง ุธุงูุฑ ูุฏุฑู
- **ูพุณโุฒููู**: ุฎุงฺฉุณุชุฑ ุฑูุดู
- **ููุฎูุงู ุจุง ูพูุงฺฏู ุงุตู**: ุทุฑุงุญ ฺฉุงููุงู ููุงููฺฏ ุจุง ูพูุงฺฏู ุงุตู

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### ูพุดโูุงุฒูุง

- WordPress 5.8 ุง ุจุงูุงุชุฑ
- PHP 7.4 ุง ุจุงูุงุชุฑ
- ูพูุงฺฏู ุงุตู Hamnaghsheh Project Management ุจุงุฏ ูุตุจ ู ูุนุงู ุจุงุดุฏ

### ูุฑุงุญู ูุตุจ

1. ูุงูโูุง ูพูุงฺฏู ุฑุง ุฏุฑ ูพูุดู `/wp-content/plugins/hamnaghsheh-chat/` ุขูพููุฏ ฺฉูุฏ
2. ุงุฒ ุทุฑู ููู 'ูพูุงฺฏูโูุง' ุฏุฑ ูุฑุฏูพุฑุณุ ูพูุงฺฏู ุฑุง ูุนุงู ฺฉูุฏ
3. ูพูุงฺฏู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฌุฏุงูู ุฏุชุงุจุณ ููุฑุฏ ูุงุฒ ุฑุง ุงุฌุงุฏ ูโฺฉูุฏ

## ุณุงุฎุชุงุฑ ุฏุชุงุจุณ

### ุฌุฏุงูู ุงุฌุงุฏ ุดุฏู

#### `{prefix}_hamnaghsheh_chat_messages`
ุฐุฎุฑูโุณุงุฒ ุชูุงู ูพุงูโูุง ฺุช

```sql
- id: ุดูุงุณู ฺฉุชุง
- project_id: ุดูุงุณู ูพุฑูฺู
- user_id: ุดูุงุณู ฺฉุงุฑุจุฑ (0 ุจุฑุง ูพุงูโูุง ุณุณุชู)
- message: ูุชู ูพุงู
- message_type: ููุน ูพุงู ('text' ุง 'system')
- is_edited: ุขุง ูพุงู ูุฑุงุด ุดุฏู ุงุณุช
- edited_at: ุฒูุงู ูุฑุงุด
- created_at: ุฒูุงู ุงุฌุงุฏ
```

#### `{prefix}_hamnaghsheh_chat_seen`
ุฑุฏุงุจ ูุถุนุช ุฏุฏู ุดุฏู ูพุงูโูุง

```sql
- id: ุดูุงุณู ฺฉุชุง
- message_id: ุดูุงุณู ูพุงู
- user_id: ุดูุงุณู ฺฉุงุฑุจุฑ
- seen_at: ุฒูุงู ุฏุฏู
```

## ุงุณุชูุงุฏู

### ุจุฑุง ฺฉุงุฑุจุฑุงู

1. ุจู ุตูุญู ฺฉ ูพุฑูฺู ุจุฑูุฏ
2. ุฌุนุจู ฺุช ุฏุฑ ูพุงู ุณูุช ฺูพ ุตูุญู ุธุงูุฑ ูโุดูุฏ
3. ุฑู ุขู ฺฉูฺฉ ฺฉูุฏ ุชุง ุจุงุฒ ุดูุฏ
4. ูพุงู ุฎูุฏ ุฑุง ุชุงูพ ฺฉุฑุฏู ู ุฏฺฉูู ุงุฑุณุงู ุฑุง ุจุฒูุฏ
5. ุงุฒ ุฏฺฉููโูุง @ ู # ุจุฑุง ููุดู ฺฉุฑุฏู ฺฉุงุฑุจุฑุงู ู ูุงูโูุง ุงุณุชูุงุฏู ฺฉูุฏ

### ููุดู ฺฉุงุฑุจุฑุงู ู ูุงูโูุง

- **ููุดู ฺฉุงุฑุจุฑ**: ุชุงูพ ฺฉูุฏ `@` ู ุณูพุณ ุดุฑูุน ุจู ููุดุชู ูุงู ฺฉุงุฑุจุฑ ฺฉูุฏ
- **ููุดู ูุงู**: ุชุงูพ ฺฉูุฏ `#` ู ุณูพุณ ุดุฑูุน ุจู ููุดุชู ูุงู ูุงู ฺฉูุฏ
- ุงุฒ ฺฉูุฏูุง ููุด ุจุฑุง ุงูุชุฎุงุจ ุงุฒ ูุณุช ุงุณุชูุงุฏู ฺฉูุฏ
- Enter ุง Tab ุฑุง ุจุฑุง ุชุงุฏ ุงูุชุฎุงุจ ูุดุงุฑ ุฏูุฏ

### ูุฑุงุด ูพุงู

- ุฑู ูพุงู ุฎูุฏ ุฏู ุจุงุฑ ฺฉูฺฉ ฺฉูุฏ (ููุท ุฏุฑ ฑฐ ุฏููู ุงูู)
- ูพุงู ุฑุง ูุฑุงุด ฺฉุฑุฏู ู ุฐุฎุฑู ฺฉูุฏ
- ูพุงูโูุง ูุฑุงุด ุดุฏู ุจุง ุจุฑฺุณุจ "(ูุฑุงุด ุดุฏู)" ููุงุด ุฏุงุฏู ูโุดููุฏ

### ูุดุงูุฏู ุฌุฒุฆุงุช ุฏุฏู ุดุฏู

- ุฑู ุนูุงูุช โโ ฺฉูุงุฑ ูพุงู ฺฉูฺฉ ฺฉูุฏ
- ูุณุช ฺฉุงุฑุจุฑุงู ฺฉู ูพุงู ุฑุง ุฏุฏูโุงูุฏ ููุงุด ุฏุงุฏู ูโุดูุฏ

### ุฎุฑูุฌ ฺฏุฑูุชู ุงุฒ ฺุช (ููุท ูุงูฺฉ ูพุฑูฺู)

- ุฑู ุฏฺฉูู ๐ฅ ุฏุฑ ูุฏุฑ ฺุช ฺฉูฺฉ ฺฉูุฏ
- ูุงู ูุชู ุจุง ฺฉุฏฺฏุฐุงุฑ UTF-8 ุฏุงูููุฏ ูโุดูุฏ

## ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู

### ุณุงุฎุชุงุฑ ูุงูโูุง

```
hamnaghsheh-chat/
โโโ hamnaghsheh-chat.php              # ูุงู ุงุตู ูพูุงฺฏู
โโโ includes/
โ   โโโ class-chat-activator.php      # ุงุฌุงุฏ ุฌุฏุงูู ุฏุชุงุจุณ
โ   โโโ class-chat-deactivator.php    # ูพุงฺฉุณุงุฒ ุฏุฑ ุบุฑูุนุงูโุณุงุฒ
โ   โโโ class-chat-messages.php       # ุนููุงุช CRUD ูพุงูโูุง
โ   โโโ class-chat-seen.php           # ุฑุฏุงุจ ูุถุนุช ุฏุฏู ุดุฏู
โ   โโโ class-chat-access.php         # ฺฉูุชุฑู ุฏุณุชุฑุณ
โ   โโโ class-chat-mentions.php       # ูพุฑุฏุงุฒุด ููุดูโูุง
โ   โโโ class-chat-export.php         # ุฎุฑูุฌ ฺฏุฑูุชู ุงุฒ ฺุช
โ   โโโ class-chat-system-messages.php # ูพุงูโูุง ุณุณุชู
โ   โโโ class-chat-renderer.php       # ุฑูุฏุฑ UI ฺุช
โโโ assets/
โ   โโโ js/
โ   โ   โโโ chat.js                   # ููุทู ุงุตู ฺุช
โ   โ   โโโ mentions.js               # ุชฺฉูู ุฎูุฏฺฉุงุฑ ููุดูโูุง
โ   โโโ css/
โ       โโโ chat.css                  # ุงุณุชุงูโูุง ฺุช
โโโ templates/
    โโโ chat-box.php                  # ูุงูุจ UI ฺุช
    โโโ admin/
        โโโ all-chats.php             # ูพูู ูุฏุฑุช
```

### AJAX Endpoints

ููู endpointโูุง AJAX ุจุง prefix `wp_ajax_hmchat_` ุดุฑูุน ูโุดููุฏ:

- `hmchat_send_message`: ุงุฑุณุงู ูพุงู ุฌุฏุฏ
- `hmchat_fetch_messages`: ุฏุฑุงูุช ูพุงูโูุง ุฌุฏุฏ
- `hmchat_load_earlier`: ุจุงุฑฺฏุฐุงุฑ ูพุงูโูุง ูุจู
- `hmchat_edit_message`: ูุฑุงุด ูพุงู
- `hmchat_mark_seen`: ุนูุงูุชโฺฏุฐุงุฑ ูพุงูโูุง ุจู ุนููุงู ุฏุฏู ุดุฏู
- `hmchat_get_seen_details`: ุฏุฑุงูุช ุฌุฒุฆุงุช ุฏุฏู ุดุฏู
- `hmchat_get_members`: ุฏุฑุงูุช ุงุนุถุง ูพุฑูฺู
- `hmchat_get_files`: ุฏุฑุงูุช ูุงูโูุง ูพุฑูฺู
- `hmchat_export_chat`: ุฎุฑูุฌ ฺฏุฑูุชู ุงุฒ ฺุช
- `hmchat_get_unread_count`: ุฏุฑุงูุช ุชุนุฏุงุฏ ูพุงูโูุง ุฎูุงูุฏู ูุดุฏู

### Hookโูุง ู ููุชุฑูุง

```php
// ุงูุฒูุฏู ููู ูุฏุฑุช ุณูุงุฑุด
add_action('admin_menu', 'your_custom_menu_function', 20);

// ุชุบุฑ ูุงุตูู polling
add_filter('hmchat_poll_interval', function($interval, $state) {
    return $interval;
}, 10, 2);
```

### ฺฉูุงุณโูุง CSS ุงุตู

```css
.hmchat-container          /* Container ุงุตู */
.hmchat-message            /* ูพุงู ุชฺฉ */
.hmchat-message.own        /* ูพุงู ฺฉุงุฑุจุฑ ุฌุงุฑ */
.hmchat-message.other      /* ูพุงู ฺฉุงุฑุจุฑุงู ุฏฺฏุฑ */
.hmchat-message.system     /* ูพุงู ุณุณุชู */
.hmchat-mention-user       /* ููุดู ฺฉุงุฑุจุฑ */
.hmchat-mention-file       /* ููุดู ูุงู */
.hmchat-unread-badge       /* ุจุฌ ุชุนุฏุงุฏ ุฎูุงูุฏู ูุดุฏู */
```

## ุงููุช

### ุชุฏุงุจุฑ ุงููุช ูพุงุฏูโุณุงุฒ ุดุฏู

- โ ุชุงุฏ Nonce ุฏุฑ ุชูุงู endpointโูุง AJAX
- โ ุจุฑุฑุณ ุฏุณุชุฑุณ ฺฉุงุฑุจุฑ ุฏุฑ ูุฑ ุฏุฑุฎูุงุณุช
- โ ูพุงฺฉุณุงุฒ ูุฑูุฏ ุจุง `sanitize_text_field()` ู `wp_kses_post()`
- โ ูุฑุงุฑ ุฎุฑูุฌ ุจุง `esc_html()`, `esc_attr()`, `esc_url()`
- โ ุฌููฺฏุฑ ุงุฒ SQL Injection ุจุง `$wpdb->prepare()`
- โ ุฌููฺฏุฑ ุงุฒ XSS ุฏุฑ ุชูุงู ูุณูุชโูุง
- โ ูุญุฏูุฏุช ูุฑุฎ: ุญุฏุงฺฉุซุฑ ณฐ ูพุงู ุฏุฑ ุฏููู
- โ ูุญุฏูุฏุช ุทูู ูพุงู: ุญุฏุงฺฉุซุฑ ฒฐฐฐ ฺฉุงุฑุงฺฉุชุฑ

## ุนููฺฉุฑุฏ

### ุจูููโุณุงุฒโูุง

- **ูุธุฑุณูุฌ ููุดููุฏ**: ููุงุตู ุฒูุงู ุชุทุจู ุจุฑ ุงุณุงุณ ูุนุงูุช ฺฉุงุฑุจุฑ
- **Lazy Loading**: ุจุงุฑฺฏุฐุงุฑ ูพุงูโูุง ูุจู ููุท ุฏุฑ ุตูุฑุช ูุงุฒ
- **ุงูุฏฺฉุณโฺฏุฐุงุฑ ุฏุชุงุจุณ**: ุงูุฏฺฉุณโูุง ุจููู ุจุฑุง ฺฉูุฆุฑโูุง ุณุฑุน
- **Batch Operations**: ุนูุงูุชโฺฏุฐุงุฑ ุฏุณุชูโุง ูพุงูโูุง ุจู ุนููุงู ุฏุฏู ุดุฏู
- **ููุชูุฑ InnoDB**: ููู ุณุทุญ ุฑุฏู ุจุฑุง ููุดุชูโูุง ููุฒูุงู

## ูุดุงุฑฺฉุช

ุงู ูพุฑูฺู ุชูุณุท Soroush Yasini ูฺฏูุฏุงุฑ ูโุดูุฏ.

## ูุงุณูุณ

GPL v2 ุง ุจุงูุงุชุฑ

## ูพุดุชุจุงู

ุจุฑุง ฺฏุฒุงุฑุด ูุดฺฉูุงุช ุง ุฏุฑุฎูุงุณุช ูฺฺฏโูุงุ ูุทูุงู ฺฉ issue ุฏุฑ ูุฎุฒู GitHub ุงุฌุงุฏ ฺฉูุฏ:
https://github.com/soroushyasini/hamnaghsheh-massenger

## ุจูโุฑูุฒุฑุณุงูโูุง

### ูุณุฎู 1.0.0
- ุงูุชุดุงุฑ ุงููู
- ุณุณุชู ฺุช ฺฉุงูู ุจุง ูุธุฑุณูุฌ ููุดููุฏ
- ูพุดุชุจุงู ุงุฒ ููุดู ฺฉุงุฑุจุฑุงู ู ูุงูโูุง
- ูพุงูโูุง ุณุณุชู ุจุฑุง ูุนุงูุชโูุง ูุงู
- ูุฑุงุด ูพุงู
- ูุถุนุช ุฏุฏู ุดุฏู
- ุฎุฑูุฌ ฺฏุฑูุชู ุงุฒ ฺุช
- ุทุฑุงุญ RTL ู ููุจุงู ุงูู
